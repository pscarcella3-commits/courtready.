<div id="train" class="view">
    <div class="content-scroll">
        <div style="padding: 50px 25px 10px;">
            <h2 style="font-size: 32px; margin: 0; font-weight: 900;">Train Lab</h2>
            <p id="coach-msg" style="color:var(--neon); font-size: 12px; font-weight: 700; text-transform: uppercase; margin-top: 5px;">Analisi dati in corso...</p>
        </div>

        <div id="training-plan">
            </div>
    </div>
</div>

<script>
    // ... mantieni le funzioni precedenti (showView, saveMatch, etc) ...

    function showView(id, el) {
        document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
        
        // Gestione corretta dell'illuminazione nav
        if(el) el.classList.add('active');
        else document.getElementById('nav-' + id).classList.add('active');

        if(id === 'train') generateTraining();
        if(id === 'match') { renderHistory(); updateAnalytics(); }
    }

    function generateTraining() {
        const planCont = document.getElementById('training-plan');
        const msg = document.getElementById('coach-msg');
        
        if (matches.length === 0) {
            msg.innerText = "REGISTRA UN MATCH PER RICEVERE UN PIANO";
            planCont.innerHTML = `<div class="card" style="text-align:center; color:#555;">Nessun dato disponibile.</div>`;
            return;
        }

        const lastMatch = matches[0];
        let exercises = [];

        // Logica di raccomandazione IA
        if (lastMatch.result === 'SCO') {
            msg.innerText = "FOCUS: RECUPERO E TECNICA";
            exercises = [
                { title: "Analisi Errori Gratuiti", desc: "Guarda il video sulla gestione del ritmo.", vid: "https://www.youtube.com/embed/dQw4w9WgXcQ", tag: "TECNICA" },
                { title: "Footwork Drill", desc: "Esercizio di 15 min sulla mobilitÃ  laterale.", vid: "https://www.youtube.com/embed/dQw4w9WgXcQ", tag: "FISICO" }
            ];
        } else {
            msg.innerText = "FOCUS: MANTENIMENTO E POTENZA";
            exercises = [
                { title: "Servizio Kick", desc: "Perfezionamento della rotazione.", vid: "https://www.youtube.com/embed/dQw4w9WgXcQ", tag: "POTENZA" },
                { title: "Mental Toughness", desc: "Esercizio di respirazione pre-match.", vid: "https://www.youtube.com/embed/dQw4w9WgXcQ", tag: "MENTAL" }
            ];
        }

        planCont.innerHTML = exercises.map(ex => `
            <div class="card">
                <span style="font-size: 9px; background: var(--neon); color: black; padding: 2px 6px; border-radius: 4px; font-weight: 900;">${ex.tag}</span>
                <h3 style="margin: 10px 0 5px 0; font-weight: 900;">${ex.title}</h3>
                <p style="font-size: 13px; color: #888; margin-bottom: 15px;">${ex.desc}</p>
                <div style="border-radius: 15px; overflow: hidden; height: 180px; background: #000; border: 1px solid #222;">
                    <iframe width="100%" height="100%" src="${ex.vid}" frameborder="0" allowfullscreen></iframe>
                </div>
            </div>
        `).join('');
    }
</script>
